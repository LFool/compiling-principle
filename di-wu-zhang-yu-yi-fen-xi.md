# 第五章 语义分析

## 1 属性文法

### **1.1 属性文法**

在上下文无关文法的基础上，为每个文法符号（终结符或非终结符）配备若干相关的 “值”（称为**属性**）

* **属性**代表与文法相关信息，如类型、值、代码序列、符号表内容等
* 属性可以进行计算和传递
* **语义规则**：对于文法的每个产生式都配备了一组属性的计算规则

### **1.2 属性**

* **综合属性**：“自下而上” 传递信息
* **继承属性**：“自上而下” 传递信息

在一个属性文法中，对应于每个产生式 $$A \rightarrow \alpha$$ 都有一套与之相关的**语义规则**，每条规则的形式为： $$b := f(c_1, c_2, \cdots, c_k)$$ ，这里， $$f$$ 是一个函数，而且或者：

1. b 是 A 的一个**综合属性** 并且  $$c_1, c_2, \cdots, c_k$$ 是产生式右边文法符号的属性
2. b 是产生式右边某个文法符号的一个**继承属性** 并且 $$c_1, c_2, \cdots, c_k$$ 是 A 或产生式右边任何文法符号的属性

### **1.3 说明**

* 终结符只有**综合属性**，由词法分析器提供
  * $$F \rightarrow digit$$ 
  * $$digit.lexval$$ 
* 非终结符既可有**综合属性**也可用**继承属性**，文法开始符号的所有继承属性作为属性计算前的初始值
  * $$F \rightarrow digit$$ 
  * $$F.val、digit.lexval$$ 
* 对于出现**产生式右边的继承属性**和**出现产生式左边的综合属性**都必须提供一个计算规则。属性计算规则只能使用相应产生式中的文法符号属性
  * $$F \rightarrow digit$$ 
  * $$F.val := digit.lexval$$ 
* 出现在**产生式左边的继承属性**和**出现在产生式右边的综合属性**不得由所给的产生式的属性计算规则计算，由其它产生式的属性规则计算或者由属性计算器的参数提供
* 语义规则所描述的工作可以包括属性计算、静态语义检查、符号表操作、代码生成等等

### 1.4 例子

非终结符考虑 A、B 和 C，其中：

* A 有一个继承属性 a 和一个综合属性 b；
* B 有综合属性 c；
* C 有继承属性 d；

产生式 $$A \rightarrow BC$$ 可能的规则有： $$C.d := B.c + 1 \\  A.b := A.a + B.c $$ ，而属性 A.a 和 B.c 在其他地方计算

### 1.5 总结

综合属性：只能由 等式右边 的 **子结点** 和 **本身** 计算

继承属性：只能由 等式左边 的 **父节点** 、**兄弟结点** 和 **本身** 计算

## 2. 基于属性文法的处理方法



